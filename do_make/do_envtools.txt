

// compiler fw_setenv
make envtools


1. 方法1 命令行传递参数静态编译 (scripts/Makefile.host:104: 查看编译规则)

1 lsb@lsb:u-boot-fslc$ make envtools KBUILD_HOSTLDFLAGS=-static 

2. 方法2： 修改Makefile 文件静态编译 (scripts/Makefile.host:104: 查看编译规则)

1 vi tools/env/Makefile 文件同添加 KBUILD_HOSTLDFLAGS = -static
2 make envtools 


root@jiuchun:env# pwd
/mnt/Desktop/project/imx-2023/u-boot-fslc/tools/env
root@jiuchun:env# 

root@jiuchun:env# cp fw_env.config /etc

root@jiuchun:env# cp fw_printenv /root

root@jiuchun:env# cd /root
root@jiuchun:~# ln -s fw_printenv fw_setenv

root@jiuchun:env# mkdir -p /var/lock


cp tools/env/fw_env.config /etc/

ln -s fw_printenv fw_setenv


lsb@lsb:u-boot-fslc$ make envtools -n --trace
lsb@lsb:u-boot-fslc$ make envtools KBUILD_HOSTLDFLAGS=-static -n --trace


scripts/Makefile.host:104: 
# Link an executable based on list of .o files, all plain c
# host-cmulti -> executable
quiet_cmd_host-cmulti	= HOSTLD  $@
      cmd_host-cmulti	= $(HOSTCC) $(KBUILD_HOSTLDFLAGS) -o $@ \
			  $(addprefix $(obj)/,$($(@F)-objs)) \
			  $(KBUILD_HOSTLDLIBS) $(HOSTLDLIBS_$(@F))
$(host-cmulti): FORCE
	$(call if_changed,host-cmulti)
$(call multi_depend, $(host-cmulti), , -objs)



scripts/Makefile.host:104: update target 'tools/env/fw_printenv' due to: tools/env/fw_env_main.o tools/env/fw_env.o tools/env/crc32.o tools/env/ctype.o tools/env/linux_string.o tools/env/env_attr.o tools/env/env_flags.o
set -e;  echo '  HOSTLD  tools/env/fw_printenv'; /opt/gcc-linaro-12.2.1-2022.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-gcc   -o tools/env/fw_printenv tools/env/fw_env_main.o tools/env/fw_env.o tools/env/crc32.o tools/env/ctype.o tools/env/linux_string.o tools/env/env_attr.o tools/env/env_flags.o   ; printf '%s\n' 'cmd_tools/env/fw_printenv := /opt/gcc-linaro-12.2.1-2022.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-gcc   -o tools/env/fw_printenv tools/env/fw_env_main.o tools/env/fw_env.o tools/env/crc32.o tools/env/ctype.o tools/env/linux_string.o tools/env/env_attr.o tools/env/env_flags.o   ' > tools/env/.fw_printenv.cmd





lsb@lsb:u-boot-fslc$ make envtools EXTRA_LDFLAGS=-static -n --trace
Makefile:495: target 'scripts_basic' does not exist
make -f ./scripts/Makefile.build obj=scripts/basic
scripts/Makefile.host:95: target 'scripts/basic/fixdep' does not exist
:
scripts/Makefile.build:93: update target '__build' due to: scripts/basic/fixdep
:
rm -f .tmp_quiet_recordmcount
Makefile:1889: update target 'include/config/uboot.release' due to: include/config/auto.conf
set -e; mkdir -p include/config/; 	echo "2023.01$(/bin/bash ./scripts/setlocalversion .)" < include/config/auto.conf > include/config/uboot.release.tmp; if [ -r include/config/uboot.release ] && cmp -s include/config/uboot.release include/config/uboot.release.tmp; then rm -f include/config/uboot.release.tmp; else echo '  UPD     include/config/uboot.release'; mv -f include/config/uboot.release.tmp include/config/uboot.release; fi
Makefile:1995: update target 'include/generated/version_autogenerated.h' due to: include/config/uboot.release
set -e; mkdir -p include/generated/; 	(echo \#define PLAIN_VERSION \"2023.01-03144-g0dfbe8b1f9\"; echo \#define U_BOOT_VERSION \"U-Boot \" PLAIN_VERSION; echo \#define U_BOOT_VERSION_NUM 2023; echo \#define U_BOOT_VERSION_NUM_PATCH $(echo 01 | sed -e "s/^0*//"); echo \#define CC_VERSION_STRING \"$(LC_ALL=C /opt/gcc-linaro-12.2.1-2022.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-gcc --version | head -n 1)\"; echo \#define LD_VERSION_STRING \"$(LC_ALL=C /opt/gcc-linaro-12.2.1-2022.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-ld.bfd --version | head -n 1)\"; ) < include/config/uboot.release > include/generated/version_autogenerated.h.tmp; if [ -r include/generated/version_autogenerated.h ] && cmp -s include/generated/version_autogenerated.h include/generated/version_autogenerated.h.tmp; then rm -f include/generated/version_autogenerated.h.tmp; else echo '  UPD     include/generated/version_autogenerated.h'; mv -f include/generated/version_autogenerated.h.tmp include/generated/version_autogenerated.h; fi
Makefile:1998: target 'include/generated/timestamp_autogenerated.h' does not exist
set -e; mkdir -p include/generated/; 	(if test -n "${SOURCE_DATE_EPOCH}"; then SOURCE_DATE="@${SOURCE_DATE_EPOCH}"; DATE=""; for date in gdate date.gnu date; do ${date} -u -d "${SOURCE_DATE}" >/dev/null 2>&1 && DATE="${date}"; done; if test -n "${DATE}"; then LC_ALL=C ${DATE} -u -d "${SOURCE_DATE}" +'#define U_BOOT_DATE "%b %d %C%y"'; LC_ALL=C ${DATE} -u -d "${SOURCE_DATE}" +'#define U_BOOT_TIME "%T"'; LC_ALL=C ${DATE} -u -d "${SOURCE_DATE}" +'#define U_BOOT_TZ "%z"'; LC_ALL=C ${DATE} -u -d "${SOURCE_DATE}" +'#define U_BOOT_EPOCH %s'; else return 42; fi; else LC_ALL=C date +'#define U_BOOT_DATE "%b %d %C%y"'; LC_ALL=C date +'#define U_BOOT_TIME "%T"'; LC_ALL=C date +'#define U_BOOT_TZ "%z"'; LC_ALL=C date +'#define U_BOOT_EPOCH %s'; fi) < Makefile > include/generated/timestamp_autogenerated.h.tmp; if [ -r include/generated/timestamp_autogenerated.h ] && cmp -s include/generated/timestamp_autogenerated.h include/generated/timestamp_autogenerated.h.tmp; then rm -f include/generated/timestamp_autogenerated.h.tmp; else echo '  UPD     include/generated/timestamp_autogenerated.h'; mv -f include/generated/timestamp_autogenerated.h.tmp include/generated/timestamp_autogenerated.h; fi
Makefile:2148: update target 'envtools' due to: scripts_basic include/generated/version_autogenerated.h include/generated/timestamp_autogenerated.h tools/version.h
make -f ./scripts/Makefile.build obj=tools/env
scripts/Makefile.host:112: target 'tools/env/crc32.o' does not exist
:
scripts/Makefile.host:112: target 'tools/env/ctype.o' does not exist
:
scripts/Makefile.host:112: target 'tools/env/env_attr.o' does not exist
:
scripts/Makefile.host:112: target 'tools/env/env_flags.o' does not exist
:
scripts/Makefile.host:112: target 'tools/env/fw_env.o' does not exist
:
scripts/Makefile.host:112: target 'tools/env/linux_string.o' does not exist
:
scripts/Makefile.build:359: update target 'tools/env/lib.a' due to: tools/env/crc32.o tools/env/ctype.o tools/env/env_attr.o tools/env/env_flags.o tools/env/fw_env.o tools/env/linux_string.o
set -e;  echo '  AR      tools/env/lib.a'; rm -f tools/env/lib.a; /opt/gcc-linaro-12.2.1-2022.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-ar cDPrsT tools/env/lib.a tools/env/crc32.o tools/env/ctype.o tools/env/env_attr.o tools/env/env_flags.o tools/env/fw_env.o tools/env/linux_string.o; printf '%s\n' 'cmd_tools/env/lib.a := rm -f tools/env/lib.a; /opt/gcc-linaro-12.2.1-2022.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-ar cDPrsT tools/env/lib.a tools/env/crc32.o tools/env/ctype.o tools/env/env_attr.o tools/env/env_flags.o tools/env/fw_env.o tools/env/linux_string.o' > tools/env/.lib.a.cmd
scripts/Makefile.host:112: target 'tools/env/fw_env_main.o' does not exist
:
scripts/Makefile.host:104: update target 'tools/env/fw_printenv' due to: tools/env/fw_env_main.o tools/env/fw_env.o tools/env/crc32.o tools/env/ctype.o tools/env/linux_string.o tools/env/env_attr.o tools/env/env_flags.o
set -e;  echo '  HOSTLD  tools/env/fw_printenv'; /opt/gcc-linaro-12.2.1-2022.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-gcc   -o tools/env/fw_printenv tools/env/fw_env_main.o tools/env/fw_env.o tools/env/crc32.o tools/env/ctype.o tools/env/linux_string.o tools/env/env_attr.o tools/env/env_flags.o   ; printf '%s\n' 'cmd_tools/env/fw_printenv := /opt/gcc-linaro-12.2.1-2022.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-gcc   -o tools/env/fw_printenv tools/env/fw_env_main.o tools/env/fw_env.o tools/env/crc32.o tools/env/ctype.o tools/env/linux_string.o tools/env/env_attr.o tools/env/env_flags.o   ' > tools/env/.fw_printenv.cmd
tools/env/Makefile:35: update target 'tools/env/.strip' due to: tools/env/fw_printenv
echo '  STRIP   tools/env/fw_printenv'; /opt/gcc-linaro-12.2.1-2022.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-strip tools/env/fw_printenv; touch tools/env/.strip
scripts/Makefile.build:333: update target 'tools/env/built-in.o' due to: FORCE
:
scripts/Makefile.build:93: update target '__build' due to: tools/env/built-in.o tools/env/lib.a tools/env/fw_printenv tools/env/.strip
:
lsb@lsb:u-boot-fslc$ 


